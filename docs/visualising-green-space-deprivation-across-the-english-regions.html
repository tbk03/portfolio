<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Visualising green space deprivation across the English regions | Data Science Portfolio</title>
  <meta name="description" content="holding text" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Visualising green space deprivation across the English regions | Data Science Portfolio" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="holding text" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Visualising green space deprivation across the English regions | Data Science Portfolio" />
  
  <meta name="twitter:description" content="holding text" />
  

<meta name="author" content="Chris J. Martin" />


<meta name="date" content="2021-04-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="predicting-course-evaluation-scores.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://tbk03.github.io/portfolio/index.html">Portfolio - Chris J. Martin</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>I Linear Regression Projects</b></span></li>
<li class="chapter" data-level="2" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><i class="fa fa-check"></i><b>2</b> Predicting the amount of plastic waste a country produces each year</a>
<ul>
<li class="chapter" data-level="2.1" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#data-importing"><i class="fa fa-check"></i><b>2.1</b> Data importing</a></li>
<li class="chapter" data-level="2.2" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#data-cleaning"><i class="fa fa-check"></i><b>2.2</b> Data cleaning</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#missing-data"><i class="fa fa-check"></i><b>2.2.1</b> Missing data</a></li>
<li class="chapter" data-level="2.2.2" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#inspecting-the-data-for-the-country-variable"><i class="fa fa-check"></i><b>2.2.2</b> Inspecting the data for the country variable</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>2.3</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="2.4" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#modelling-a-simple-regression-model"><i class="fa fa-check"></i><b>2.4</b> Modelling: A simple regression model</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#model-fitting"><i class="fa fa-check"></i><b>2.4.1</b> Model fitting</a></li>
<li class="chapter" data-level="2.4.2" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#uncertainty-in-the-model-fit"><i class="fa fa-check"></i><b>2.4.2</b> Uncertainty in the model fit</a></li>
<li class="chapter" data-level="2.4.3" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#reviewing-the-residuals"><i class="fa fa-check"></i><b>2.4.3</b> Reviewing the residuals</a></li>
<li class="chapter" data-level="2.4.4" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#bayesian-r-squared"><i class="fa fa-check"></i><b>2.4.4</b> Bayesian R squared</a></li>
<li class="chapter" data-level="2.4.5" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#cross-validation-and-log-scores"><i class="fa fa-check"></i><b>2.4.5</b> Cross validation and log scores</a></li>
<li class="chapter" data-level="2.4.6" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#graphical-posterior-predictive-checks"><i class="fa fa-check"></i><b>2.4.6</b> Graphical posterior predictive checks</a></li>
<li class="chapter" data-level="2.4.7" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#summary-of-the-model-fitting-process"><i class="fa fa-check"></i><b>2.4.7</b> Summary of the model fitting process</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html"><a href="predicting-the-amount-of-plastic-waste-a-country-produces-each-year.html#applying-the-model-to-new-data"><i class="fa fa-check"></i><b>2.5</b> Applying the model to new data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><i class="fa fa-check"></i><b>3</b> Estimating the proportion of plastic waste countries mismanage</a>
<ul>
<li class="chapter" data-level="3.1" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#data-importing-and-cleaning"><i class="fa fa-check"></i><b>3.1</b> Data importing and cleaning</a></li>
<li class="chapter" data-level="3.2" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>3.2</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="3.3" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#modelling-piecewise-linear-regression"><i class="fa fa-check"></i><b>3.3</b> Modelling: Piecewise linear regression</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#fitting-the-model"><i class="fa fa-check"></i><b>3.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.3.2" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#interpreting-the-model-coefficients"><i class="fa fa-check"></i><b>3.3.2</b> Interpreting the model coefficients</a></li>
<li class="chapter" data-level="3.3.3" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#some-quick-diagnostics"><i class="fa fa-check"></i><b>3.3.3</b> Some quick diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="estimating-the-proportion-of-plastic-waste-countries-mismanage.html"><a href="estimating-the-proportion-of-plastic-waste-countries-mismanage.html#reflections-and-next-steps"><i class="fa fa-check"></i><b>3.4</b> Reflections and next steps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html"><i class="fa fa-check"></i><b>4</b> Predicting course evaluation scores</a>
<ul>
<li class="chapter" data-level="4.1" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#data-importing-and-cleaning-1"><i class="fa fa-check"></i><b>4.1</b> Data importing and cleaning</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#importing-the-data"><i class="fa fa-check"></i><b>4.1.1</b> Importing the data</a></li>
<li class="chapter" data-level="4.1.2" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#checking-for-missing-values"><i class="fa fa-check"></i><b>4.1.2</b> Checking for missing values</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#exploratory-data-analysis-2"><i class="fa fa-check"></i><b>4.2</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#the-response-variable"><i class="fa fa-check"></i><b>4.2.1</b> The response variable</a></li>
<li class="chapter" data-level="4.2.2" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#potential-explanatory-variables"><i class="fa fa-check"></i><b>4.2.2</b> Potential explanatory variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#relationships-between-variables"><i class="fa fa-check"></i><b>4.2.3</b> Relationships between variables</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#modelling"><i class="fa fa-check"></i><b>4.3</b> Modelling</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#splitting-the-data"><i class="fa fa-check"></i><b>4.3.1</b> Splitting the data</a></li>
<li class="chapter" data-level="4.3.2" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#minimal-and-maximal-models"><i class="fa fa-check"></i><b>4.3.2</b> Minimal and maximal models</a></li>
<li class="chapter" data-level="4.3.3" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#iteration-1-adding-two-continuous-variables"><i class="fa fa-check"></i><b>4.3.3</b> Iteration 1: Adding two continuous variables</a></li>
<li class="chapter" data-level="4.3.4" data-path="predicting-course-evaluation-scores.html"><a href="predicting-course-evaluation-scores.html#iteration-2"><i class="fa fa-check"></i><b>4.3.4</b> Iteration 2:</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Vizualisation Projects</b></span></li>
<li class="chapter" data-level="5" data-path="visualising-green-space-deprivation-across-the-english-regions.html"><a href="visualising-green-space-deprivation-across-the-english-regions.html"><i class="fa fa-check"></i><b>5</b> Visualising green space deprivation across the English regions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualising-green-space-deprivation-across-the-english-regions" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Visualising green space deprivation across the English regions</h1>
<p>In another notebook I conducted an exploratory analysis of green space deprivation data published by Friends of the Earth in the Autumn of 2020. Friends of Earth rated the extent of green space deprivation in each neighborhood (each middle-layer-super-output-area in language of UK administrative geography) in England. One of the interesting findings from this exploratory data analysis was that London has a much higher rate of neighborhoods experiencing the worst forms of green space deprivation than other English regions.</p>
<p>I wanted to explore ways to visually communicate this finding, looking beyond a geographic representation where it would have challenging to convey this finding due to differences in the density of regions across the UK. In the end I settled up the waffle chat below (basically a slight adaptation on the familiar bar chart). The design of the visualization was inspired by this <a href="https://github.com/cxinya/tidy-tuesday/blob/main/2021_week-11_bechdel/2021_week-11_bechdel.R">#TidyTuesday post</a>.</p>
<p>Reflecting on the process of producing the plot, I noted:</p>
<ul>
<li><p>The difference font styles and colour palettes can make to the visual identity of a plot;</p></li>
<li><p>That perhaps the additional effort and time required to produce a waffle plot (verses a standard bar chart) would be difficult to justify in the future;</p></li>
<li><p>That I had learnt a considerable amount using the <code>theme</code> function from <code>ggplot2</code> to customize the visual design of a plot.</p></li>
</ul>
<p>I hope these learnings will be useful in producing visualisations which convey the findings of the data science projects I am working on at the moment. I also thought it was important to avoid getting caught up in the visual design of plots being produced as part of statistical analyses. Given the small, technical audiences for the later, the default themes from <code>ggplot2</code> are likely to be more than good enough.</p>
<p>In the code below, I read in, clean and reshape the data before producing the plot itself.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import core libraries</span></span>
<span id="cb143-2"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb143-3"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)  <span class="co"># for cleaning the variables names in the imported data</span></span>
<span id="cb143-4"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)   <span class="co"># for reading in data in an Excel format</span></span>
<span id="cb143-5"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># import libraries used for building the plot</span></span>
<span id="cb143-7"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waffle)</span>
<span id="cb143-8"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb143-9"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb143-10"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb143-11"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridisLite)</span>
<span id="cb143-12"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb143-13"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="co"># import fonts to be used in the final figure</span></span>
<span id="cb143-15"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">import_roboto_condensed</span>()</span>
<span id="cb143-16"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-19"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="co"># READ IN AND CLEAN DATA</span></span>
<span id="cb143-20"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-20" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-21"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; reads in the Friends of the Earth Green Space Dataset</span></span>
<span id="cb143-23"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb143-24"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return: a tibble with consistently named variables</span></span>
<span id="cb143-25"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-25" aria-hidden="true" tabindex="-1"></a>read_foe_data <span class="ot">&lt;-</span>  <span class="cf">function</span>(){</span>
<span id="cb143-26"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-27"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-27" aria-hidden="true" tabindex="-1"></a>  green_space <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;./data/(FOE) Green Space Consolidated Data - England - Version 2.1.xlsx&quot;</span>,</span>
<span id="cb143-28"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-28" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sheet =</span> <span class="st">&quot;MSOAs V2.1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-29"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># inconsistent naming conventions for variables are used in the source data</span></span>
<span id="cb143-30"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># some needed to clean names for consistency (variables names are now )</span></span>
<span id="cb143-31"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>()</span>
<span id="cb143-32"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-33"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(green_space)</span>
<span id="cb143-34"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-35"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-36"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-37"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-37" aria-hidden="true" tabindex="-1"></a><span class="co"># read in FOE data</span></span>
<span id="cb143-38"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-38" aria-hidden="true" tabindex="-1"></a>foe_green_space <span class="ot">&lt;-</span> <span class="fu">read_foe_data</span>()</span>
<span id="cb143-39"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-40"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-40" aria-hidden="true" tabindex="-1"></a><span class="co"># focus on variables of interest for visualisation</span></span>
<span id="cb143-41"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-41" aria-hidden="true" tabindex="-1"></a>foe_green_space_focus <span class="ot">&lt;-</span> foe_green_space <span class="sc">%&gt;%</span> </span>
<span id="cb143-42"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(msoa_code, msoa_name, la_code, green_space_deprivation_rating)</span>
<span id="cb143-43"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-44"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-44" aria-hidden="true" tabindex="-1"></a><span class="co"># The FOE green space data doesn&#39;t include a variable for the region each </span></span>
<span id="cb143-45"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-45" aria-hidden="true" tabindex="-1"></a><span class="co"># MSOA/local authority lies within So, import a look up table from the ONS,</span></span>
<span id="cb143-46"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-46" aria-hidden="true" tabindex="-1"></a><span class="co"># which maps between Local Authority Districts and Regions</span></span>
<span id="cb143-47"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-47" aria-hidden="true" tabindex="-1"></a>LAD_to_region <span class="ot">&lt;-</span> </span>
<span id="cb143-48"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;./data/Local_Authority_District_to_Region__December_2019__Lookup_in_England.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-49"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>FID, <span class="sc">-</span>LAD19NM)</span>
<span id="cb143-50"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-51"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-51" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the FOE green space and ONS region tibbles</span></span>
<span id="cb143-52"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-52" aria-hidden="true" tabindex="-1"></a>green_space_regions <span class="ot">&lt;-</span> foe_green_space_focus <span class="sc">%&gt;%</span> </span>
<span id="cb143-53"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(LAD_to_region, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;la_code&quot;</span> <span class="ot">=</span> <span class="st">&quot;LAD19CD&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-54"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> RGN19NM,</span>
<span id="cb143-55"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">region_code =</span> RGN19CD)</span>
<span id="cb143-56"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-57"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-58"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-58" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-59"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-59" aria-hidden="true" tabindex="-1"></a><span class="co"># RESHAPE DATA FOR PLOTTING</span></span>
<span id="cb143-60"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-60" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-61"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-62"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; adds a column of shorten region names which are easier read/use in plots</span></span>
<span id="cb143-63"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb143-64"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param df: a data frame including a region variable (with standard ONS region names)</span></span>
<span id="cb143-65"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb143-66"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return: an amended data frame with an additional column of short region names </span></span>
<span id="cb143-67"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-67" aria-hidden="true" tabindex="-1"></a>add_region_short_names <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb143-68"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-69"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-69" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb143-70"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">region_short =</span> <span class="fu">case_when</span>(</span>
<span id="cb143-71"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-71" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;East Midlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;E. Mids.&quot;</span>,</span>
<span id="cb143-72"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-72" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;East of England&quot;</span> <span class="sc">~</span> <span class="st">&quot;E. Eng.&quot;</span>,</span>
<span id="cb143-73"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-73" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;North East&quot;</span> <span class="sc">~</span> <span class="st">&quot;NE&quot;</span>,</span>
<span id="cb143-74"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-74" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;North West&quot;</span> <span class="sc">~</span> <span class="st">&quot;NW&quot;</span>,</span>
<span id="cb143-75"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-75" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;South East&quot;</span> <span class="sc">~</span> <span class="st">&quot;SE&quot;</span>,</span>
<span id="cb143-76"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-76" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;South West&quot;</span> <span class="sc">~</span> <span class="st">&quot;SW&quot;</span>,</span>
<span id="cb143-77"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-77" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;West Midlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;W. Mids&quot;</span>,</span>
<span id="cb143-78"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-78" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;Yorkshire and The Humber&quot;</span> <span class="sc">~</span> <span class="st">&quot;Yorks.&quot;</span>,</span>
<span id="cb143-79"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-79" aria-hidden="true" tabindex="-1"></a>      region <span class="sc">==</span> <span class="st">&quot;London&quot;</span> <span class="sc">~</span> <span class="st">&quot;Lon.&quot;</span>,</span>
<span id="cb143-80"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-80" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> region),</span>
<span id="cb143-81"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">region_short =</span> <span class="fu">str_to_upper</span>(region_short)</span>
<span id="cb143-82"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb143-83"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-84"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb143-85"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-86"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-86" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-87"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-88"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-88" aria-hidden="true" tabindex="-1"></a><span class="co"># process the FOE data for plotting including:</span></span>
<span id="cb143-89"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-89" aria-hidden="true" tabindex="-1"></a><span class="co"># counting the number of neighborhoods with each rating in each region</span></span>
<span id="cb143-90"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-90" aria-hidden="true" tabindex="-1"></a><span class="co"># and, adding in shorter easier to plot region names</span></span>
<span id="cb143-91"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-91" aria-hidden="true" tabindex="-1"></a>region_ratings_counts <span class="ot">&lt;-</span> green_space_regions <span class="sc">%&gt;%</span> </span>
<span id="cb143-92"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(region)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-93"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, green_space_deprivation_rating) <span class="sc">%&gt;%</span> </span>
<span id="cb143-94"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb143-95"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_region_short_names</span>()</span>
<span id="cb143-96"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-97"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-98"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-98" aria-hidden="true" tabindex="-1"></a><span class="co"># define an indicator variable identifying if urgent action is needed </span></span>
<span id="cb143-99"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-99" aria-hidden="true" tabindex="-1"></a><span class="co"># in a neighborhood to address green space deprivation </span></span>
<span id="cb143-100"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-100" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. identify if each neighborhood is rated D or E)</span></span>
<span id="cb143-101"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-101" aria-hidden="true" tabindex="-1"></a><span class="co"># this indicator variables is used for ordering the regions in the plot</span></span>
<span id="cb143-102"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-102" aria-hidden="true" tabindex="-1"></a>urgent_action_counts <span class="ot">&lt;-</span> green_space_regions <span class="sc">%&gt;%</span> </span>
<span id="cb143-103"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_region_short_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb143-104"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D_or_E =</span> green_space_deprivation_rating <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-105"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region_short) <span class="sc">%&gt;%</span> </span>
<span id="cb143-106"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_D_or_E =</span> <span class="fu">sum</span>(D_or_E)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-107"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb143-108"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_D_or_E))</span>
<span id="cb143-109"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-110"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the counts of the numbers of neighborhoods in each region with each </span></span>
<span id="cb143-111"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-111" aria-hidden="true" tabindex="-1"></a><span class="co"># green space deprivation rating, and add in the urgent action counts for each</span></span>
<span id="cb143-112"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-112" aria-hidden="true" tabindex="-1"></a><span class="co"># region</span></span>
<span id="cb143-113"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-113" aria-hidden="true" tabindex="-1"></a>region_ratings_counts <span class="ot">&lt;-</span> region_ratings_counts <span class="sc">%&gt;%</span> </span>
<span id="cb143-114"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(urgent_action_counts) <span class="sc">%&gt;%</span> </span>
<span id="cb143-115"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_short =</span> <span class="fu">factor</span>(region_short, </span>
<span id="cb143-116"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-116" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">pull</span>(urgent_action_counts, </span>
<span id="cb143-117"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-117" aria-hidden="true" tabindex="-1"></a>                                             region_short)),</span>
<span id="cb143-118"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">green_space_deprivation_rating =</span> <span class="fu">factor</span>(green_space_deprivation_rating,</span>
<span id="cb143-119"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-119" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;C&quot;</span>, </span>
<span id="cb143-120"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-120" aria-hidden="true" tabindex="-1"></a>                                                            <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb143-121"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># needed to reorder ratings in each column</span></span>
<span id="cb143-122"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(green_space_deprivation_rating)</span>
<span id="cb143-123"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-124"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-125"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-125" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-126"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-126" aria-hidden="true" tabindex="-1"></a><span class="co"># PRODUCE THE PLOT</span></span>
<span id="cb143-127"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-127" aria-hidden="true" tabindex="-1"></a><span class="co">#******************************************************************************</span></span>
<span id="cb143-128"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-129"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-129" aria-hidden="true" tabindex="-1"></a><span class="co"># define the colour palette to be used in the plot</span></span>
<span id="cb143-130"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-130" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> <span class="dv">1</span>, <span class="at">direction =</span> <span class="dv">1</span>,<span class="at">option =</span><span class="st">&quot;A&quot;</span>)</span>
<span id="cb143-131"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-131" aria-hidden="true" tabindex="-1"></a>bg_colour <span class="ot">&lt;-</span> <span class="st">&quot;#dee3e3&quot;</span></span>
<span id="cb143-132"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-133"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-133" aria-hidden="true" tabindex="-1"></a><span class="co"># define the degree transparency used to de-emphasis neighborhoods where urgent</span></span>
<span id="cb143-134"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-134" aria-hidden="true" tabindex="-1"></a><span class="co"># action to address green space is not required</span></span>
<span id="cb143-135"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-135" aria-hidden="true" tabindex="-1"></a>alpha_hr <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb143-136"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-137"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-137" aria-hidden="true" tabindex="-1"></a><span class="co"># create the base of the plot</span></span>
<span id="cb143-138"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-138" aria-hidden="true" tabindex="-1"></a>waf <span class="ot">&lt;-</span> region_ratings_counts <span class="sc">%&gt;%</span> </span>
<span id="cb143-139"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> green_space_deprivation_rating, <span class="at">values =</span> n <span class="sc">/</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb143-140"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb143-141"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb143-142"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>(<span class="at">grid=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-143"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_enhance_waffle</span>() <span class="sc">+</span></span>
<span id="cb143-144"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>, <span class="at">colour =</span> <span class="cn">NULL</span>)</span>
<span id="cb143-145"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-146"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-147"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-147" aria-hidden="true" tabindex="-1"></a><span class="co"># add various layers to the base of the blot to produce the final figure  </span></span>
<span id="cb143-148"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-148" aria-hidden="true" tabindex="-1"></a>waf <span class="sc">+</span> <span class="fu">geom_waffle</span>(<span class="at">n_rows =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb143-149"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-149" aria-hidden="true" tabindex="-1"></a>                  <span class="at">flip =</span> <span class="cn">TRUE</span>,</span>
<span id="cb143-150"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-150" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour =</span> bg_colour) <span class="sc">+</span></span>
<span id="cb143-151"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-152"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># de-emphasis neighborhoods where urgent action to address green space </span></span>
<span id="cb143-153"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is not required</span></span>
<span id="cb143-154"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(pal[<span class="dv">1</span>], pal[<span class="dv">2</span>], </span>
<span id="cb143-155"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-155" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">alpha</span>(pal[<span class="dv">3</span>], alpha_hr), </span>
<span id="cb143-156"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-156" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">alpha</span>(pal[<span class="dv">4</span>], alpha_hr), </span>
<span id="cb143-157"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-157" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">alpha</span>(pal[<span class="dv">5</span>], alpha_hr))) <span class="sc">+</span></span>
<span id="cb143-158"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-159"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-159" aria-hidden="true" tabindex="-1"></a>  <span class="co"># immitate a bar chart through facetting</span></span>
<span id="cb143-160"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region_short, </span>
<span id="cb143-161"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-161" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb143-162"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-162" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-163"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-164"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># format legend</span></span>
<span id="cb143-165"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Green space</span><span class="sc">\n</span><span class="st">deprivation</span><span class="sc">\n</span><span class="st">rating&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-166"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb143-167"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-168"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme settings for plot area from example code</span></span>
<span id="cb143-169"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb143-170"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-170" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb143-171"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-172"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># custom theme settings for plot area</span></span>
<span id="cb143-173"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bg_colour, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb143-174"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-174" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Roboto Condensed&quot;</span>),</span>
<span id="cb143-175"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-175" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Roboto Condensed&quot;</span>),</span>
<span id="cb143-176"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-176" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">25</span>, <span class="at">l =</span> <span class="dv">25</span>),</span>
<span id="cb143-177"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-177" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb143-178"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-179"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add text areas to plot</span></span>
<span id="cb143-180"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb143-181"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">str_to_upper</span>(<span class="st">&quot;Green space deprived neighborhoods across the English regions&quot;</span>),</span>
<span id="cb143-182"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Friends of the Earth analysed green space deprivation across England. </span></span>
<span id="cb143-183"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-183" aria-hidden="true" tabindex="-1"></a><span class="st">They gave the most green space deprived neighborhoods (i.e. msoas) a rating of E, and the least a rating of A.</span></span>
<span id="cb143-184"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-184" aria-hidden="true" tabindex="-1"></a><span class="st">Urgent action is needed to address green space deprivation in neighborhoods rated D and E.</span></span>
<span id="cb143-185"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-185" aria-hidden="true" tabindex="-1"></a><span class="st">The number of neighborhoods where urgent action is needed is much higher in London than in other regions of England.</span></span>
<span id="cb143-186"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-186" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;</span>,</span>
<span id="cb143-187"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-188"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Note: each square represents 10 neighborhoods    |   Source: Friends of the Earth - England&#39;s Green Space Gap&quot;</span>,</span>
<span id="cb143-189"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-190"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-190" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom theme settings for text areas</span></span>
<span id="cb143-191"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Roboto Condensed&quot;</span>),</span>
<span id="cb143-192"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-192" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bg_colour, <span class="at">colour =</span> <span class="cn">NA</span>))</span>
<span id="cb143-193"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb143-193" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="04_green_space_data_story_telling_files/figure-html/unnamed-chunk-2-1.png" width="960" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># option to save the final figure as a .png</span></span>
<span id="cb144-2"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb144-2" aria-hidden="true" tabindex="-1"></a>visualisation_output <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb144-3"><a href="visualising-green-space-deprivation-across-the-english-regions.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(visualisation_output) <span class="fu">ggsave</span>(<span class="st">&quot;num_neigh_gs_dep.png&quot;</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="predicting-course-evaluation-scores.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04_green_space_data_story_telling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
